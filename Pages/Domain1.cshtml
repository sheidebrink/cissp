@page
@model Domain1Model
@{
    ViewData["Title"] = "Domain 1 - Security and Risk Management";
}

<div class="container mt-4">
    <div class="row">
        <div class="col-md-12">
            <!-- Domain Switcher -->
            <div class="domain-switcher mb-3">
                <div class="btn-group" role="group">
                    <a href="/Domain1" class="btn btn-primary btn-sm">D1</a>
                    <a href="/Domain2" class="btn btn-outline-primary btn-sm">D2</a>
                    <a href="/Domain3" class="btn btn-outline-primary btn-sm">D3</a>
                    <a href="/Domain4" class="btn btn-outline-primary btn-sm">D4</a>
                    <a href="/Domain5" class="btn btn-outline-primary btn-sm">D5</a>
                    <a href="/Domain6" class="btn btn-outline-primary btn-sm">D6</a>
                    <a href="/Domain7" class="btn btn-outline-primary btn-sm">D7</a>
                    <a href="/Domain8" class="btn btn-outline-primary btn-sm">D8</a>
                </div>
            </div>
            
            <h1>Domain 1: Security and Risk Management</h1>
            <p class="lead">Foundational concepts of information security and risk management.</p>
            
            <div class="card mt-4">
                <div class="card-body">
                    <h5>Key Topics (15+ Areas)</h5>
                    <ul>
                        <li>Confidentiality, Integrity, and Availability (CIA Triad)</li>
                        <li>Risk assessment and management (ALE, SLE, ARO calculations)</li>
                        <li>Security governance and compliance frameworks</li>
                        <li>Legal and regulatory requirements (GDPR, HIPAA, SOX)</li>
                        <li>Professional ethics and codes of conduct</li>
                        <li>STRIDE threat modeling methodology</li>
                        <li>Risk Management Maturity (RMM) levels</li>
                        <li>Business continuity and disaster recovery planning</li>
                        <li>Security awareness and training programs</li>
                        <li>Incident response and management</li>
                        <li>Vendor and third-party risk management</li>
                        <li>Security metrics and key performance indicators</li>
                        <li>Due diligence and due care concepts</li>
                        <li>Security policies, standards, and procedures</li>
                        <li>Change management and configuration control</li>
                        <li>Personnel security and background checks</li>
                        <li>Physical and environmental security controls</li>
                        <li>Business impact analysis (BIA)</li>
                        <li>Quantitative vs qualitative risk analysis</li>
                        <li>Security control frameworks (NIST, ISO 27001)</li>
                    </ul>
                </div>
            </div>
            
            <div class="card mt-4">
                <div class="card-body">
                    <h5>CIA Triad - Foundation of Information Security</h5>
                    <div class="row">
                        <div class="col-md-4 mb-4">
                            <div class="card border-primary">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0">ðŸ”’ Confidentiality</h6>
                                </div>
                                <div class="card-body">
                                    <p><strong>Definition:</strong> Ensuring information is accessible only to authorized individuals</p>
                                    <p><strong>Controls:</strong></p>
                                    <ul>
                                        <li>Encryption (at rest & in transit)</li>
                                        <li>Access controls (RBAC, MAC, DAC)</li>
                                        <li>Authentication & authorization</li>
                                        <li>Data classification</li>
                                        <li>NDAs and legal agreements</li>
                                    </ul>
                                    <p><strong>Threats:</strong></p>
                                    <ul>
                                        <li>Data breaches</li>
                                        <li>Unauthorized access</li>
                                        <li>Social engineering</li>
                                        <li>Insider threats</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4 mb-4">
                            <div class="card border-success">
                                <div class="card-header bg-success text-white">
                                    <h6 class="mb-0">âœ… Integrity</h6>
                                </div>
                                <div class="card-body">
                                    <p><strong>Definition:</strong> Ensuring information remains accurate, complete, and unaltered</p>
                                    <p><strong>Controls:</strong></p>
                                    <ul>
                                        <li>Digital signatures</li>
                                        <li>Hash functions (MD5, SHA)</li>
                                        <li>Checksums and CRCs</li>
                                        <li>Version control systems</li>
                                        <li>Input validation</li>
                                        <li>Change management</li>
                                    </ul>
                                    <p><strong>Threats:</strong></p>
                                    <ul>
                                        <li>Data tampering</li>
                                        <li>Malware corruption</li>
                                        <li>Human error</li>
                                        <li>System failures</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4 mb-4">
                            <div class="card border-warning">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="mb-0">âš¡ Availability</h6>
                                </div>
                                <div class="card-body">
                                    <p><strong>Definition:</strong> Ensuring information and systems are accessible when needed</p>
                                    <p><strong>Controls:</strong></p>
                                    <ul>
                                        <li>Redundancy and failover</li>
                                        <li>Load balancing</li>
                                        <li>Backup and recovery</li>
                                        <li>Disaster recovery planning</li>
                                        <li>Maintenance schedules</li>
                                        <li>Capacity planning</li>
                                    </ul>
                                    <p><strong>Threats:</strong></p>
                                    <ul>
                                        <li>DDoS attacks</li>
                                        <li>Hardware failures</li>
                                        <li>Natural disasters</li>
                                        <li>Power outages</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card mt-4">
                <div class="card-body">
                    <h5>CIA Triad Implementation Examples</h5>
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Scenario</th>
                                    <th>Confidentiality</th>
                                    <th>Integrity</th>
                                    <th>Availability</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Banking System</strong></td>
                                    <td>Encrypt customer data, secure login</td>
                                    <td>Transaction validation, audit trails</td>
                                    <td>24/7 uptime, redundant systems</td>
                                </tr>
                                <tr>
                                    <td><strong>Medical Records</strong></td>
                                    <td>HIPAA compliance, access controls</td>
                                    <td>Digital signatures, version control</td>
                                    <td>Emergency access, backup systems</td>
                                </tr>
                                <tr>
                                    <td><strong>E-commerce Site</strong></td>
                                    <td>SSL/TLS, PCI DSS compliance</td>
                                    <td>Order verification, payment validation</td>
                                    <td>Load balancing, CDN, DDoS protection</td>
                                </tr>
                                <tr>
                                    <td><strong>Government Data</strong></td>
                                    <td>Classification levels, clearances</td>
                                    <td>Chain of custody, tamper evidence</td>
                                    <td>Continuity of operations planning</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-4">
                        <h6>Key Principles</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <ul>
                                    <li><strong>Balance:</strong> All three elements must be considered together</li>
                                    <li><strong>Context:</strong> Importance varies by organization and data type</li>
                                    <li><strong>Trade-offs:</strong> Enhancing one may impact others</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <ul>
                                    <li><strong>Risk-based:</strong> Apply controls based on risk assessment</li>
                                    <li><strong>Layered:</strong> Use defense in depth approach</li>
                                    <li><strong>Measurable:</strong> Define metrics for each component</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Risk Assessment Calculations -->
            <div class="card mt-4">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0">ðŸ“Š Risk Assessment Calculations</h5>
                </div>
                <div class="card-body">
                    <div class="alert alert-warning">
                        <strong>CISSP Exam Focus:</strong> Memorize these formulas and understand how to apply them in scenarios.
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Core Risk Formulas</h6>
                            
                            <div class="formula-card bg-light p-3 mb-3 border">
                                <h6 class="text-primary">AV - Asset Value</h6>
                                <p class="mb-2"><strong>Definition:</strong> The monetary value of an asset</p>
                                <div class="formula-box bg-white p-2 border">
                                    <code>AV = Replacement Cost + Data Value + Productivity Loss</code>
                                </div>
                                <p class="small mt-2"><strong>Example:</strong> Server worth $10,000 + Data worth $50,000 + Downtime cost $5,000 = $65,000 AV</p>
                            </div>
                            
                            <div class="formula-card bg-light p-3 mb-3 border">
                                <h6 class="text-primary">EF - Exposure Factor</h6>
                                <p class="mb-2"><strong>Definition:</strong> Percentage of asset value lost if threat occurs</p>
                                <div class="formula-box bg-white p-2 border">
                                    <code>EF = % of Asset Value Lost (0.0 to 1.0)</code>
                                </div>
                                <p class="small mt-2"><strong>Examples:</strong> Fire destroys server = 1.0 (100%), Virus corrupts 30% of data = 0.3 (30%)</p>
                            </div>
                            
                            <div class="formula-card bg-light p-3 mb-3 border">
                                <h6 class="text-primary">SLE - Single Loss Expectancy</h6>
                                <p class="mb-2"><strong>Definition:</strong> Expected monetary loss from a single threat occurrence</p>
                                <div class="formula-box bg-white p-2 border">
                                    <code>SLE = AV Ã— EF</code>
                                </div>
                                <p class="small mt-2"><strong>Example:</strong> $65,000 AV Ã— 0.3 EF = $19,500 SLE</p>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="formula-card bg-light p-3 mb-3 border">
                                <h6 class="text-primary">ARO - Annualized Rate of Occurrence</h6>
                                <p class="mb-2"><strong>Definition:</strong> Expected frequency of threat occurrence per year</p>
                                <div class="formula-box bg-white p-2 border">
                                    <code>ARO = Number of Times Per Year</code>
                                </div>
                                <p class="small mt-2"><strong>Examples:</strong> Daily = 365, Monthly = 12, Once every 5 years = 0.2</p>
                            </div>
                            
                            <div class="formula-card bg-light p-3 mb-3 border">
                                <h6 class="text-primary">ALE - Annualized Loss Expectancy</h6>
                                <p class="mb-2"><strong>Definition:</strong> Expected monetary loss per year from a specific threat</p>
                                <div class="formula-box bg-white p-2 border">
                                    <code>ALE = SLE Ã— ARO</code>
                                </div>
                                <p class="small mt-2"><strong>Example:</strong> $19,500 SLE Ã— 0.2 ARO = $3,900 ALE</p>
                            </div>
                            
                            <div class="formula-card bg-light p-3 mb-3 border">
                                <h6 class="text-primary">Cost-Benefit Analysis</h6>
                                <p class="mb-2"><strong>Definition:</strong> Determine if safeguard is cost-effective</p>
                                <div class="formula-box bg-white p-2 border">
                                    <code>Annual Savings = ALE(before) - ALE(after) - Annual Safeguard Cost</code>
                                </div>
                                <p class="small mt-2"><strong>Rule:</strong> Implement safeguard only if Annual Savings > 0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <h6>Practical Example Scenario</h6>
                        <div class="example-scenario bg-info bg-opacity-10 p-3 border border-info">
                            <p><strong>Scenario:</strong> E-commerce server vulnerable to DDoS attacks</p>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <strong>Given Values:</strong>
                                    <ul class="small">
                                        <li>Server replacement cost: $15,000</li>
                                        <li>Revenue loss during downtime: $50,000</li>
                                        <li>DDoS causes 100% service unavailability</li>
                                        <li>DDoS attacks occur twice per year</li>
                                        <li>DDoS protection service costs $8,000/year</li>
                                        <li>Protection reduces impact to 10%</li>
                                    </ul>
                                </div>
                                
                                <div class="col-md-6">
                                    <strong>Calculations:</strong>
                                    <ul class="small">
                                        <li>AV = $15,000 + $50,000 = $65,000</li>
                                        <li>EF (without protection) = 1.0 (100%)</li>
                                        <li>SLE = $65,000 Ã— 1.0 = $65,000</li>
                                        <li>ARO = 2 (twice per year)</li>
                                        <li>ALE (before) = $65,000 Ã— 2 = $130,000</li>
                                        <li>ALE (after) = $65,000 Ã— 0.1 Ã— 2 = $13,000</li>
                                        <li>Annual Savings = $130,000 - $13,000 - $8,000 = $109,000</li>
                                    </ul>
                                    <div class="alert alert-success mt-2">
                                        <strong>Decision:</strong> Implement DDoS protection (saves $109,000/year)
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <h6>Key Exam Tips</h6>
                        <div class="row">
                            <div class="col-md-4">
                                <strong>Formula Memory</strong>
                                <ul class="small">
                                    <li>SLE = AV Ã— EF</li>
                                    <li>ALE = SLE Ã— ARO</li>
                                    <li>ALE = AV Ã— EF Ã— ARO</li>
                                </ul>
                            </div>
                            <div class="col-md-4">
                                <strong>Common Mistakes</strong>
                                <ul class="small">
                                    <li>Confusing EF as dollar amount (it's a percentage)</li>
                                    <li>Forgetting to convert time periods to annual</li>
                                    <li>Not including all cost components in AV</li>
                                </ul>
                            </div>
                            <div class="col-md-4">
                                <strong>Decision Rules</strong>
                                <ul class="small">
                                    <li>Safeguard cost < ALE reduction = Implement</li>
                                    <li>Consider qualitative factors too</li>
                                    <li>Multiple threats may share safeguards</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- STRIDE Threat Model -->
            <div class="card mt-4">
                <div class="card-header bg-warning text-dark">
                    <h5 class="mb-0">ðŸŽ¯ STRIDE Threat Model</h5>
                </div>
                <div class="card-body">
                    <p class="text-muted mb-3">STRIDE is a threat modeling methodology developed by Microsoft to identify security threats.</p>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="stride-item mb-3 p-3 border-start border-danger border-3">
                                <h6 class="text-danger">S - Spoofing</h6>
                                <p class="small mb-1"><strong>Definition:</strong> Impersonating another user or system</p>
                                <p class="small mb-1"><strong>Examples:</strong> IP spoofing, email spoofing, identity theft</p>
                                <p class="small text-muted"><strong>Countermeasures:</strong> Authentication, digital certificates</p>
                            </div>
                            
                            <div class="stride-item mb-3 p-3 border-start border-warning border-3">
                                <h6 class="text-warning">T - Tampering</h6>
                                <p class="small mb-1"><strong>Definition:</strong> Unauthorized modification of data or code</p>
                                <p class="small mb-1"><strong>Examples:</strong> Data corruption, code injection, file modification</p>
                                <p class="small text-muted"><strong>Countermeasures:</strong> Digital signatures, integrity checks</p>
                            </div>
                            
                            <div class="stride-item mb-3 p-3 border-start border-info border-3">
                                <h6 class="text-info">R - Repudiation</h6>
                                <p class="small mb-1"><strong>Definition:</strong> Denying actions or transactions</p>
                                <p class="small mb-1"><strong>Examples:</strong> Denying sent emails, disputed transactions</p>
                                <p class="small text-muted"><strong>Countermeasures:</strong> Digital signatures, audit logs</p>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="stride-item mb-3 p-3 border-start border-primary border-3">
                                <h6 class="text-primary">I - Information Disclosure</h6>
                                <p class="small mb-1"><strong>Definition:</strong> Unauthorized access to confidential data</p>
                                <p class="small mb-1"><strong>Examples:</strong> Data breaches, eavesdropping, information leakage</p>
                                <p class="small text-muted"><strong>Countermeasures:</strong> Encryption, access controls</p>
                            </div>
                            
                            <div class="stride-item mb-3 p-3 border-start border-secondary border-3">
                                <h6 class="text-secondary">D - Denial of Service</h6>
                                <p class="small mb-1"><strong>Definition:</strong> Making systems or services unavailable</p>
                                <p class="small mb-1"><strong>Examples:</strong> DDoS attacks, resource exhaustion</p>
                                <p class="small text-muted"><strong>Countermeasures:</strong> Rate limiting, redundancy</p>
                            </div>
                            
                            <div class="stride-item mb-3 p-3 border-start border-success border-3">
                                <h6 class="text-success">E - Elevation of Privilege</h6>
                                <p class="small mb-1"><strong>Definition:</strong> Gaining unauthorized higher-level access</p>
                                <p class="small mb-1"><strong>Examples:</strong> Privilege escalation, admin account compromise</p>
                                <p class="small text-muted"><strong>Countermeasures:</strong> Least privilege, access reviews</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info mt-3">
                        <strong>CISSP Exam Tip:</strong> Remember STRIDE as a systematic approach to identify threats during security architecture design.
                    </div>
                </div>
            </div>
            
            <!-- Risk Management Maturity (RMM) Levels -->
            <div class="card mt-4">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">ðŸ“ˆ Risk Management Maturity (RMM) Levels</h5>
                </div>
                <div class="card-body">
                    <p class="text-muted mb-3">RMM provides a framework for assessing an organization's risk management capabilities.</p>
                    
                    <div class="rmm-levels">
                        <div class="rmm-level mb-3 p-3 bg-light border">
                            <h6 class="text-danger">Level 1 - Ad Hoc</h6>
                            <ul class="small">
                                <li>Chaotic starting point with no formal processes</li>
                                <li>Risk management is reactive and inconsistent</li>
                                <li>No standardized approach across organization</li>
                            </ul>
                        </div>
                        
                        <div class="rmm-level mb-3 p-3 bg-light border">
                            <h6 class="text-warning">Level 2 - Preliminary</h6>
                            <ul class="small">
                                <li>Loose attempts to follow risk management processes</li>
                                <li>Each department may perform risk assessment uniquely</li>
                                <li>Some documentation but inconsistent application</li>
                            </ul>
                        </div>
                        
                        <div class="rmm-level mb-3 p-3 bg-light border">
                            <h6 class="text-primary">Level 3 - Defined</h6>
                            <ul class="small">
                                <li><strong>Common or standardized risk framework adopted organization-wide</strong></li>
                                <li>Documented processes and procedures</li>
                                <li>Consistent risk assessment methodologies</li>
                            </ul>
                        </div>
                        
                        <div class="rmm-level mb-3 p-3 bg-light border">
                            <h6 class="text-success">Level 4 - Integrated</h6>
                            <ul class="small">
                                <li>Risk management operations integrated into business processes</li>
                                <li>Metrics used to gather effectiveness data</li>
                                <li>Risk considered an element in business strategy decisions</li>
                            </ul>
                        </div>
                        
                        <div class="rmm-level mb-3 p-3 bg-light border">
                            <h6 class="text-info">Level 5 - Optimized</h6>
                            <ul class="small">
                                <li>Risk management focuses on achieving objectives rather than just reacting</li>
                                <li>Strategic planning toward business success rather than just avoiding incidents</li>
                                <li>Lessons learned reintegrated into the risk management process</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="alert alert-warning mt-3">
                        <strong>CISSP Exam Focus:</strong> Level 3 (Defined) requires a common/standardized risk framework organization-wide.
                    </div>
                </div>
            </div>
            
            <div class="mt-4">
                <a href="/Quiz?domain=Security and Risk Management" class="btn btn-primary">Practice Domain Questions</a>
                <a href="/Quiz" class="btn btn-outline-primary">All Questions</a>
                <a href="/" class="btn btn-secondary">Back to Home</a>
            </div>
            
            <!-- Domain Navigation -->
            <div class="domain-navigation mt-5 pt-4 border-top">
                <div class="d-flex justify-content-end">
                    <a href="/Domain2" class="btn btn-outline-secondary">
                        Next: Domain 2 <i class="fas fa-chevron-right"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>